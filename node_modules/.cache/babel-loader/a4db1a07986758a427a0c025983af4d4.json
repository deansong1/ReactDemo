{"ast":null,"code":"var _jsxFileName = \"D:\\\\\\u6211\\u7684\\u9879\\u76EE\\\\ReactDemo\\\\src\\\\jspLumb\\\\Demo3.js\";\nimport React, { Component } from 'react'; // import './TablePage.css';\n\nimport \"./demo.less\"; // import {Table,Row, Col,Button} from 'antd';\n\nimport $ from 'jquery';\nimport 'antd/dist/antd.css';\nimport jsplumb from 'jsplumb';\nimport 'jquery-ui/ui/widgets/draggable';\nimport 'jquery-ui/ui/widgets/droppable';\nimport block0 from \"./images/little-icon/screen.gif\";\nimport block1 from \"./images/little-icon/camera.gif\";\nimport block2 from \"./images/little-icon/print.gif\";\nimport block3 from \"./images/little-icon/firework.gif\";\nimport logo from \"./images/logo.gif\";\nimport ModelChart from \"./modelChart.js\";\nconst jsPlumb = jsplumb.jsPlumb;\n\nclass TablePage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.mOpen = () => {\n      let newProps = parseInt(this.state.propsWatch);\n      this.setState({\n        model: {\n          title: \"新增\",\n          visible: true\n        },\n        propsWatch: newProps++\n      }); // return this.state.new_value\n    };\n\n    this.onFinishFailed = values => {} //  console.log('验证失败：', values);\n    //  modal中form表单验证成功函数\n    ;\n\n    this.onFinish = values => {\n      console.log(values);\n      this.setState({\n        new_value: values.tp_no,\n        model: {\n          visible: false\n        }\n      }); //   document.getElementById(\"elebox\").innerHTML = this.state.new_value;\n    };\n\n    this.state = {\n      new_value: \"\",\n      form_info: [{\n        title: '工序号',\n        dataIndex: 'tp_no',\n        key: 'tp_no'\n      }],\n      conn_data: [[{\n        \"lineColor\": \"#61b7cf\",\n        \"connectionLabel\": \"安装\",\n        \"PageSourceId\": \"uiprint_0\",\n        \"PageTargetId\": \"uiprint_1\"\n      }, {\n        \"lineColor\": \"#2f8e00\",\n        \"connectionLabel\": \"连接\",\n        \"PageSourceId\": \"uiprint_0\",\n        \"PageTargetId\": \"uicamera_0\"\n      }, {\n        \"lineColor\": \"#0074b0\",\n        \"connectionLabel\": \"冷备\",\n        \"PageSourceId\": \"uiprint_0\",\n        \"PageTargetId\": \"uiscreen_0\"\n      }, {\n        \"lineColor\": \"#b267ce\",\n        \"connectionLabel\": \"文档\",\n        \"PageSourceId\": \"uiprint_0\",\n        \"PageTargetId\": \"uicamera_1\"\n      }, {\n        \"lineColor\": \"#7c4f2e\",\n        \"connectionLabel\": \"使用\",\n        \"PageSourceId\": \"uiprint_1\",\n        \"PageTargetId\": \"uicamera_1\"\n      }, {\n        \"lineColor\": \"#e28b1a\",\n        \"connectionLabel\": \"依赖\",\n        \"PageSourceId\": \"uiprint_1\",\n        \"PageTargetId\": \"uicamera_0\"\n      }, {\n        \"lineColor\": \"#0074b0\",\n        \"connectionLabel\": \"冷备\",\n        \"PageSourceId\": \"uicamera_0\",\n        \"PageTargetId\": \"uicamera_1\"\n      }], [{\n        \"BlockId\": \"uiscreen_0\",\n        'nodeType': 4,\n        \"BlockClass\": \"uiscreen\",\n        \"BlockImg\": \"images/big-icon/screen.gif\",\n        \"BlockText\": \"显示器\",\n        \"BlockX\": 74,\n        \"BlockY\": 125\n      }, {\n        \"BlockId\": \"uicamera_0\",\n        \"BlockClass\": \"uicamera\",\n        \"BlockImg\": \"images/big-icon/camera.gif\",\n        \"BlockText\": \"摄像头\",\n        \"BlockX\": 517,\n        \"BlockY\": 115\n      }, {\n        \"BlockId\": \"uicamera_1\",\n        'nodeType': 4,\n        \"BlockClass\": \"uicamera\",\n        \"BlockImg\": \"images/big-icon/camera.gif\",\n        \"BlockText\": \"摄像头\",\n        \"BlockX\": 84,\n        \"BlockY\": 448\n      }, {\n        \"BlockId\": \"uiprint_0\",\n        \"BlockClass\": \"uiprint\",\n        \"BlockImg\": \"images/big-icon/print.gif\",\n        \"BlockText\": \"打印机\",\n        \"BlockX\": 400,\n        \"BlockY\": 256\n      }, {\n        \"BlockId\": \"uiprint_1\",\n        \"BlockClass\": \"uiprint\",\n        \"BlockImg\": \"images/big-icon/print.gif\",\n        \"BlockText\": \"打印机\",\n        \"BlockX\": 703,\n        \"BlockY\": 476\n      }]],\n      model: {\n        title: \"新增\",\n        visible: false\n      },\n      propsWatch: 1\n    };\n  }\n\n  componentDidMount() {\n    console.log(this.props);\n    this.jsplumbIn();\n  }\n\n  componentWillUnmount() {}\n\n  jsplumbIn() {\n    //-------------------编辑(start)-------------------\n    var topocontent = $('#topocontent'),\n        lefticon = $('#lefticon'),\n        linewrap = $('#linewrap'); //连接样式\n\n    var lineColorArr = ['#b267ce', '#7c4f2e', '#0074b0', '#b02929', '#e28b1a', '#48daff', '#61b7cf', '#2f8e00'],\n        relationArr = ['文档', '使用', '冷备', '热备', '依赖', '父子', '安装', '连接'],\n        instance = jsPlumb.getInstance({\n      Endpoint: [\"Dot\", {\n        radius: 2\n      }],\n      ConnectionOverlays: [[\"Arrow\", {\n        location: 1,\n        id: \"arrow\",\n        length: 10,\n        foldback: 0.8,\n        width: 10\n      }], [\"Label\", {\n        label: \"关系\",\n        id: \"label\",\n        cssClass: \"labelstyle\"\n      }]],\n      DragOptions: {\n        zIndex: 2000\n      },\n      Container: \"#topocontent\"\n    });\n    window.jsp = instance;\n    var labelTxt = relationArr[6],\n        lineColor = lineColorArr[6],\n        pstyle = {\n      Endpoint: [\"Dot\", {\n        radius: 2\n      }],\n      paintStyle: {\n        stroke: lineColor,\n        fill: lineColor\n      },\n      connector: [\"Flowchart\", {\n        stub: [0, 0],\n        gap: 2,\n        cornerRadius: 5,\n        alwaysRespectStubs: true\n      }],\n      connectorStyle: {\n        lineWidth: 1,\n        stroke: lineColor\n      },\n      maxConnections: -1\n    }; //加载已有数据\n\n    if (this.props.initData === \"3\") {\n      let response = this.state.conn_data;\n      editData(response);\n    }\n\n    ;\n\n    function editData(response) {\n      var list = eval(response[0]),\n          blocks = eval(response[1]),\n          htmlText = \"\",\n          htmlSvg = \"\"; //------------插入元素-------------\n\n      for (let i in blocks) {\n        var viewstyle = 'left:' + blocks[i].BlockX + 'px;top:' + blocks[i].BlockY + 'px;',\n            viewid = blocks[i].BlockId,\n            viewClass = blocks[i].BlockClass,\n            // viewsrc = blocks[i].BlockImg,\n        viewType = blocks[i].nodeType,\n            viewTxt = blocks[i].BlockText;\n        htmlText = htmlText + `<div class=\"elebox ${viewClass} ${viewType === 4 ? \"lin\" : \"\"}\" id=${viewid} style=${viewstyle}><span class=\"dragPoint\"><div></div>${viewTxt}\n               </span></div>`; // htmlSvg = htmlSvg + '<div class=\"elebox '+viewClass+'\" id='+viewid+' style='+viewstyle+\n        // '><svg width=\"100%\" height=\"100%\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M 50 0,L 100 30,L 50 60,L 0 30,Z\" version=\"1.1\" class=\"dragPoint\" xmlns=\"http://www.w3.org/2000/xhtml\" style={{ fill:\"red\",stroke:\"#000\",strokeWidth:1}} ></path>'\n        //        +'</svg></div>' \n        // '><span class=\"dragPoint\">'+viewTxt+'</span></div>';\n\n        topocontent.html(htmlText); //    if(viewType === 4){\n        //        $(\"#\"+viewid).addClass(\"lin\");\n        //     };\n      }\n\n      ; //------------默认连接-------------\n\n      var windowsDrag = jsPlumb.getSelector(\"#topocontent .elebox\");\n      renderConnect(windowsDrag); //------------更改样式-------------\n\n      for (var i in list) {\n        var conor = instance.connect({\n          source: list[i].PageSourceId,\n          target: list[i].PageTargetId\n        });\n        conor.getOverlay(\"label\").setLabel(list[i].connectionLabel);\n        conor.setPaintStyle({\n          fillStyle: list[i].lineColor,\n          stroke: list[i].lineColor\n        });\n        conor.bind('click', function () {\n          detachLine(this);\n        });\n      }\n\n      ; // $(\"div.elebox\").draggable({ containment: \"parent\" });\n    } //自定义鼠标事件\n\n\n    var rightkeyPop = $('#rightkeyPop'),\n        relationWrap = $('#relationWrap'),\n        relevanceBox = $('#relevanceBox');\n    linewrap.find('span').each(function (i) {\n      //点解切换关系\n      var $this = $(this);\n      $this.click(function () {\n        linewrap.find('span').removeClass('focus');\n        $this.addClass('focus');\n        labelTxt = relationArr[i];\n        lineColor = lineColorArr[i];\n      });\n    });\n    $(document).on(\"contextmenu\", function () {\n      return false;\n    });\n    $(document).on('mousedown', '#topocontent div.elebox', function (event) {\n      if (event.which === 3) {\n        var $this = $(this),\n            event = event || window.event,\n            oLeft = parseInt(event.clientX),\n            oTop = parseInt(event.clientY),\n            // span = $this.children('span'),\n        idStr = $this.attr('id');\n        rightkeyPop.css({\n          left: oLeft,\n          top: oTop,\n          zIndex: 2999\n        }).attr('rightkey_click_id', idStr).show();\n      }\n    });\n    $(document).on('mouseout', '#topocontent div.elebox', function () {\n      rightkeyPop.hide();\n    });\n    $(document).on('mouseover', '#topocontent div.elebox', function () {\n      return false;\n    });\n    $(document).on('click', '#delEle', function () {\n      let idStr = rightkeyPop.attr('rightkey_click_id'); // $.confirmInfo({\n      //     title : '删除元素及链接',\n      //     text : '确认删除此元素及其链接吗？',\n      //     sure : function(){\n\n      instance.removeAllEndpoints(idStr);\n      instance.remove(idStr); //     }\n      // });\n    });\n    $(document).on('click', '#relationWrap a', function () {\n      var txt = $(this).text(),\n          idStr = rightkeyPop.attr('rightkey_click_id');\n      $('#' + idStr).children('span').text(txt);\n      relationWrap.hide();\n      rightkeyPop.hide();\n      instance.revalidate(idStr);\n    });\n    rightkeyPop.mouseover(function () {\n      $(this).show();\n      return false;\n    });\n    relevanceBox.hover(function () {\n      relationWrap.show();\n    }, function () {\n      relationWrap.hide();\n    });\n    $('body').mouseover(function () {\n      rightkeyPop.hide();\n    }); //jsPlumb事件\n\n    instance.bind(\"click\", function (info) {\n      //点解连接线删除连接（bug,点击endpoint也能删除，但是点击label能提示不能删除）\n      detachLine(info);\n    });\n    instance.bind(\"connection\", function (info, originalEvent) {\n      //更改label关系\n      console.log(info);\n      info.connection.getOverlay(\"label\").setLabel(labelTxt);\n    });\n    instance.bind(\"connectionDrag\", function (info) {\n      //更改连接链颜色\n      info.setPaintStyle({\n        fillStyle: lineColor,\n        stroke: lineColor\n      });\n    });\n    instance.bind(\"connectionDragStop\", function (info) {\n      //点击连接线、overlay、label提示删除连线 + 不能以自己作为目标元素\n      if (info.sourceId === info.targetId) {\n        // $.popupTips('不能以自己作为目标元素');\n        instance.detach(info);\n      } else {\n        info.unbind('click');\n        info.bind('click', function () {\n          detachLine(info);\n        });\n      }\n\n      ;\n    });\n\n    function detachLine(info) {\n      //删除连接\n      // $.confirmInfo({\n      //     title : '删除连接',\n      //     text : '确认删除此链接吗？',\n      //     sure : function(){\n      instance.detach(info); // }\n      // });\n    }\n\n    function renderConnect(newid) {\n      //渲染\n      instance.draggable(newid);\n      instance.doWhileSuspended(function () {\n        var isFilterSupported = instance.isDragSupported();\n\n        if (isFilterSupported) {\n          instance.makeSource(newid, {\n            filter: \".dragPoint\",\n            anchor: \"Continuous\"\n          }, pstyle);\n        } else {\n          var eps = jsPlumb.getSelector(\".dragPoint\");\n\n          for (var i = 0; i < eps.length; i++) {\n            var e = eps[i],\n                p = e.parentNode;\n            instance.makeSource(e, {\n              parent: p,\n              anchor: \"Continuous\"\n            }, pstyle);\n          }\n        }\n      });\n      instance.makeTarget(newid, {\n        dropOptions: {\n          hoverClass: \"dragHover\"\n        },\n        anchor: \"Continuous\"\n      }, pstyle);\n    } //拖动创建元素\n\n\n    lefticon.children('div.iconitems').draggable({\n      helper: 'clone',\n      scope: 'topo'\n    });\n    var mm = this.mOpen; // var {new_value} = this.state;\n\n    topocontent.droppable({\n      scope: 'topo',\n      drop: function (event, ui) {\n        mm(); //获取基本元素与参数\n\n        var $this = $(this),\n            dragui = ui.draggable,\n            fatop = parseInt($this.offset().top),\n            faleft = parseInt($this.offset().left),\n            uitop = parseInt(ui.offset.top),\n            uileft = parseInt(ui.offset.left),\n            spantxt = dragui.children('span').text(),\n            uid = dragui.attr('icontype'),\n            alluid = topocontent.children('div.' + uid); //ID计算\n\n        var allicon = alluid.length,\n            idnum = 0,\n            idArr = [];\n        alluid.each(function (i) {\n          idArr.push(parseInt($(this).attr('id').split('_')[1]));\n        });\n        idArr.sort(function (a, b) {\n          return a > b ? 1 : -1;\n        });\n\n        for (var i = 0; i < allicon; i++) {\n          var idArrOne = parseInt(idArr[i]);\n\n          if (i !== idArrOne) {\n            idnum = idArrOne - 1;\n            break;\n          } else {\n            idnum = allicon;\n          }\n        } //插入元素组织\n\n\n        var newstyle = 'left:' + (uileft - faleft) + 'px;top:' + (uitop - fatop) + 'px',\n            newid = uid + '_' + idnum,\n            str = '<div class=\"elebox ' + uid + '\" id=' + newid + ' style=' + newstyle + '><span class=\"dragPoint\">' + spantxt + '</span></div>';\n        $this.append(str);\n        renderConnect(newid);\n        instance.revalidate(newid); // $(\"#\" + newid).draggable({ containment: \"parent\" });\n      }\n    }); //-------------------编辑(end)-------------------\n  }\n\n  handleOk() {\n    this.setState({\n      model: {\n        visible: false\n      }\n    });\n  }\n\n  handleCancel() {\n    this.setState({\n      model: {\n        visible: false\n      }\n    });\n  } //  modal中form表单验证失败函数\n\n\n  viewClick() {\n    $(\"#lefticon\").css(\"background\", \"green\").toggle().slideUp(2000).slideDown(2000);\n    ;\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"topocon\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"topoleft\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 426,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"companylogo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: logo,\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 46\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"lefticon\",\n      id: \"lefticon\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 428,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"iconitems\",\n      icontype: \"uiscreen\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 429,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: block0,\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 431,\n        columnNumber: 25\n      }\n    }, \"\\u663E\\u793A\\u5668\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"iconitems\",\n      icontype: \"uicamera\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 433,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: block1,\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 25\n      }\n    }, \"\\u6444\\u50CF\\u5934\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"iconitems\",\n      icontype: \"uiprint\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 437,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: block2,\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 438,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 439,\n        columnNumber: 25\n      }\n    }, \"\\u6253\\u5370\\u673A\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"iconitems\",\n      icontype: \"uifirework\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: block3,\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 442,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 443,\n        columnNumber: 25\n      }\n    }, \"\\u9632\\u706B\\u5899\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"iconitems lin\",\n      icontype: \"uifirework\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 452,\n        columnNumber: 25\n      }\n    }, \"\\u9632\\u706B\\u5899\")))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"toporight\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 456,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"funcbtn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 457,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"morebtn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 458,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      id: \"saveTopoBtn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 459,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"font\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 459,\n        columnNumber: 48\n      }\n    }, \"\\u4FDD\\u5B58\")), /*#__PURE__*/React.createElement(\"span\", {\n      id: \"viewTopoBtn\",\n      onClick: this.viewClick.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 460,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"font\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 460,\n        columnNumber: 84\n      }\n    }, \"\\u9884\\u89C8\")))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"topocontent\",\n      id: \"topocontent\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 463,\n        columnNumber: 17\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"rightkeypop\",\n      id: \"rightkeyPop\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 466,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"delele\",\n      id: \"delEle\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 467,\n        columnNumber: 13\n      }\n    }, \"\\u5220\\u9664\\u5143\\u7D20\")), /*#__PURE__*/React.createElement(ModelChart, {\n      propsWatch: this.state.new_value,\n      model: this.state.model,\n      onOk: this.handleOk.bind(this),\n      onCancel: this.handleCancel.bind(this),\n      onFinishFailed: this.onFinishFailed.bind(this),\n      onFinish: this.onFinish.bind(this),\n      formInfo: this.state.form_info,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 469,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nexport default TablePage;","map":{"version":3,"sources":["D:/我的项目/ReactDemo/src/jspLumb/Demo3.js"],"names":["React","Component","$","jsplumb","block0","block1","block2","block3","logo","ModelChart","jsPlumb","TablePage","constructor","props","mOpen","newProps","parseInt","state","propsWatch","setState","model","title","visible","onFinishFailed","values","onFinish","console","log","new_value","tp_no","form_info","dataIndex","key","conn_data","componentDidMount","jsplumbIn","componentWillUnmount","topocontent","lefticon","linewrap","lineColorArr","relationArr","instance","getInstance","Endpoint","radius","ConnectionOverlays","location","id","length","foldback","width","label","cssClass","DragOptions","zIndex","Container","window","jsp","labelTxt","lineColor","pstyle","paintStyle","stroke","fill","connector","stub","gap","cornerRadius","alwaysRespectStubs","connectorStyle","lineWidth","maxConnections","initData","response","editData","list","eval","blocks","htmlText","htmlSvg","i","viewstyle","BlockX","BlockY","viewid","BlockId","viewClass","BlockClass","viewType","nodeType","viewTxt","BlockText","html","windowsDrag","getSelector","renderConnect","conor","connect","source","PageSourceId","target","PageTargetId","getOverlay","setLabel","connectionLabel","setPaintStyle","fillStyle","bind","detachLine","rightkeyPop","relationWrap","relevanceBox","find","each","$this","click","removeClass","addClass","document","on","event","which","oLeft","clientX","oTop","clientY","idStr","attr","css","left","top","show","hide","removeAllEndpoints","remove","txt","text","children","revalidate","mouseover","hover","info","originalEvent","connection","sourceId","targetId","detach","unbind","newid","draggable","doWhileSuspended","isFilterSupported","isDragSupported","makeSource","filter","anchor","eps","e","p","parentNode","parent","makeTarget","dropOptions","hoverClass","helper","scope","mm","droppable","drop","ui","dragui","fatop","offset","faleft","uitop","uileft","spantxt","uid","alluid","allicon","idnum","idArr","push","split","sort","a","b","idArrOne","newstyle","str","append","handleOk","handleCancel","viewClick","toggle","slideUp","slideDown","render"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\n// import './TablePage.css';\r\nimport \"./demo.less\";\r\n// import {Table,Row, Col,Button} from 'antd';\r\nimport $ from 'jquery';\r\nimport 'antd/dist/antd.css';\r\nimport jsplumb from 'jsplumb';\r\nimport 'jquery-ui/ui/widgets/draggable'\r\nimport 'jquery-ui/ui/widgets/droppable'\r\nimport block0 from \"./images/little-icon/screen.gif\"\r\nimport block1 from \"./images/little-icon/camera.gif\"\r\nimport block2 from \"./images/little-icon/print.gif\"\r\nimport block3 from \"./images/little-icon/firework.gif\"\r\nimport logo from \"./images/logo.gif\"\r\nimport ModelChart from \"./modelChart.js\"\r\n\r\nconst jsPlumb = jsplumb.jsPlumb;\r\nclass TablePage extends Component{\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            new_value:\"\",\r\n            form_info:[{\r\n                title: '工序号',\r\n                dataIndex: 'tp_no',\r\n                key: 'tp_no',\r\n              }],\r\n            conn_data :[\r\n                [{\r\n                \"lineColor\": \"#61b7cf\",\r\n                \"connectionLabel\": \"安装\",\r\n                \"PageSourceId\": \"uiprint_0\",\r\n                \"PageTargetId\": \"uiprint_1\"\r\n            },\r\n            {\r\n                \"lineColor\": \"#2f8e00\",\r\n                \"connectionLabel\": \"连接\",\r\n                \"PageSourceId\": \"uiprint_0\",\r\n                \"PageTargetId\": \"uicamera_0\"\r\n            },\r\n            {\r\n                \"lineColor\": \"#0074b0\",\r\n                \"connectionLabel\": \"冷备\",\r\n                \"PageSourceId\": \"uiprint_0\",\r\n                \"PageTargetId\": \"uiscreen_0\"\r\n            },\r\n            {\r\n                \"lineColor\": \"#b267ce\",\r\n                \"connectionLabel\": \"文档\",\r\n                \"PageSourceId\": \"uiprint_0\",\r\n                \"PageTargetId\": \"uicamera_1\"\r\n            },\r\n            {\r\n                \"lineColor\": \"#7c4f2e\",\r\n                \"connectionLabel\": \"使用\",\r\n                \"PageSourceId\": \"uiprint_1\",\r\n                \"PageTargetId\": \"uicamera_1\"\r\n            },\r\n            {\r\n                \"lineColor\": \"#e28b1a\",\r\n                \"connectionLabel\": \"依赖\",\r\n                \"PageSourceId\": \"uiprint_1\",\r\n                \"PageTargetId\": \"uicamera_0\"\r\n            },\r\n            {\r\n                \"lineColor\": \"#0074b0\",\r\n                \"connectionLabel\": \"冷备\",\r\n                \"PageSourceId\": \"uicamera_0\",\r\n                \"PageTargetId\": \"uicamera_1\"\r\n            }] , [{\r\n                \"BlockId\": \"uiscreen_0\",\r\n                'nodeType':4,\r\n                \"BlockClass\": \"uiscreen\",\r\n                \"BlockImg\": \"images/big-icon/screen.gif\",\r\n                \"BlockText\": \"显示器\",\r\n                \"BlockX\": 74,\r\n                \"BlockY\": 125\r\n            },\r\n            {\r\n                \"BlockId\": \"uicamera_0\",\r\n                \"BlockClass\": \"uicamera\",\r\n                \"BlockImg\": \"images/big-icon/camera.gif\",\r\n                \"BlockText\": \"摄像头\",\r\n                \"BlockX\": 517,\r\n                \"BlockY\": 115\r\n            },\r\n            {\r\n                \"BlockId\": \"uicamera_1\",\r\n                'nodeType':4,\r\n                \"BlockClass\": \"uicamera\",\r\n                \"BlockImg\": \"images/big-icon/camera.gif\",\r\n                \"BlockText\": \"摄像头\",\r\n                \"BlockX\": 84,\r\n                \"BlockY\": 448\r\n            },\r\n            {\r\n                \"BlockId\": \"uiprint_0\",\r\n                \"BlockClass\": \"uiprint\",\r\n                \"BlockImg\": \"images/big-icon/print.gif\",\r\n                \"BlockText\": \"打印机\",\r\n                \"BlockX\": 400,\r\n                \"BlockY\": 256\r\n            },\r\n            {\r\n                \"BlockId\": \"uiprint_1\",\r\n                \"BlockClass\": \"uiprint\",\r\n                \"BlockImg\": \"images/big-icon/print.gif\",\r\n                \"BlockText\": \"打印机\",\r\n                \"BlockX\": 703,\r\n                \"BlockY\": 476\r\n            },\r\n           ]\r\n        ],\r\n           model:{\r\n               title:\"新增\",\r\n               visible: false,\r\n           },\r\n           propsWatch:1,\r\n        };\r\n    }\r\n   \r\n    componentDidMount(){\r\n            console.log(this.props);\r\n            this.jsplumbIn()\r\n        }\r\n        componentWillUnmount(){\r\n\r\n        }\r\n    jsplumbIn(){\r\n        //-------------------编辑(start)-------------------\r\n        var topocontent = $('#topocontent'),\r\n            lefticon = $('#lefticon'),\r\n            linewrap = $('#linewrap');\r\n        //连接样式\r\n        var lineColorArr = ['#b267ce', '#7c4f2e', '#0074b0', '#b02929', '#e28b1a', '#48daff', '#61b7cf', '#2f8e00'],\r\n            relationArr = ['文档', '使用', '冷备', '热备', '依赖', '父子', '安装', '连接'],\r\n            instance = jsPlumb.getInstance({\r\n                Endpoint : [\"Dot\", {radius:2}],\r\n                ConnectionOverlays : [\r\n                    [ \"Arrow\", {location: 1, id:\"arrow\", length:10, foldback:0.8, width: 10} ],\r\n                    [ \"Label\", { label:\"关系\", id:\"label\", cssClass:\"labelstyle\" }]\r\n                ],\r\n                DragOptions : { zIndex:2000 },\r\n                Container:\"#topocontent\"\r\n            });\r\n        window.jsp = instance;\r\n\r\n        var labelTxt = relationArr[6],\r\n            lineColor = lineColorArr[6],\r\n            pstyle = {\r\n                Endpoint: [\"Dot\", { radius: 2 }],\r\n                paintStyle: {\r\n                    stroke: lineColor,\r\n                    fill: lineColor\r\n                },\r\n                connector: [\"Flowchart\", {stub: [0, 0], gap: 2, cornerRadius: 5, alwaysRespectStubs: true }],\r\n                connectorStyle: {\r\n                    lineWidth: 1,\r\n                    stroke: lineColor\r\n                },\r\n                maxConnections: -1\r\n            };\r\n\r\n        //加载已有数据\r\n        if(this.props.initData ===\"3\"){\r\n                let response = this.state.conn_data;\r\n                editData(response);\r\n            \r\n        };\r\n        function editData(response){\r\n            var list = eval(response[0]),\r\n                blocks = eval(response[1]),\r\n                htmlText = \"\",\r\n                htmlSvg = \"\";\r\n            //------------插入元素-------------\r\n            for( let i in blocks){\r\n                var viewstyle = 'left:'+blocks[i].BlockX+'px;top:'+blocks[i].BlockY+'px;',\r\n                    viewid = blocks[i].BlockId,\r\n                    viewClass = blocks[i].BlockClass,\r\n                    // viewsrc = blocks[i].BlockImg,\r\n                    viewType = blocks[i].nodeType,\r\n                    viewTxt = blocks[i].BlockText;\r\n                htmlText = htmlText + `<div class=\"elebox ${viewClass} ${viewType===4?\"lin\":\"\"}\" id=${viewid} style=${viewstyle}><span class=\"dragPoint\"><div></div>${viewTxt}\r\n               </span></div>`;\r\n                // htmlSvg = htmlSvg + '<div class=\"elebox '+viewClass+'\" id='+viewid+' style='+viewstyle+\r\n                // '><svg width=\"100%\" height=\"100%\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M 50 0,L 100 30,L 50 60,L 0 30,Z\" version=\"1.1\" class=\"dragPoint\" xmlns=\"http://www.w3.org/2000/xhtml\" style={{ fill:\"red\",stroke:\"#000\",strokeWidth:1}} ></path>'\r\n                //        +'</svg></div>' \r\n                // '><span class=\"dragPoint\">'+viewTxt+'</span></div>';\r\n                topocontent.html(htmlText);\r\n            //    if(viewType === 4){\r\n            //        $(\"#\"+viewid).addClass(\"lin\");\r\n            //     };\r\n            };\r\n\r\n           \r\n            \r\n            //------------默认连接-------------\r\n            var windowsDrag = jsPlumb.getSelector(\"#topocontent .elebox\");\r\n            renderConnect(windowsDrag);\r\n            \r\n            //------------更改样式-------------\r\n            for(var i in list){\r\n                var conor = instance.connect({ source: list[i].PageSourceId, target:list[i].PageTargetId});\r\n                conor.getOverlay(\"label\").setLabel(list[i].connectionLabel);\r\n                conor.setPaintStyle({fillStyle : list[i].lineColor, stroke: list[i].lineColor});\r\n                conor.bind('click',function(){\r\n                    detachLine(this);\r\n                });\r\n            };\r\n            // $(\"div.elebox\").draggable({ containment: \"parent\" });\r\n        }\r\n\r\n        //自定义鼠标事件\r\n        var rightkeyPop = $('#rightkeyPop'),\r\n            relationWrap = $('#relationWrap'),\r\n            relevanceBox = $('#relevanceBox');\r\n        linewrap.find('span').each(function(i) {//点解切换关系\r\n            var $this = $(this);\r\n            $this.click(function(){\r\n                linewrap.find('span').removeClass('focus');\r\n                $this.addClass('focus');\r\n                labelTxt = relationArr[i];\r\n                lineColor = lineColorArr[i];\r\n            });\r\n        });\r\n        $(document).on(\"contextmenu\", function() { return false; }); \r\n        $(document).on('mousedown', '#topocontent div.elebox', function(event){\r\n            if(event.which === 3){\r\n                var $this = $(this),\r\n                    event = event || window.event,\r\n                    oLeft = parseInt(event.clientX),\r\n                    oTop = parseInt(event.clientY),\r\n                    // span = $this.children('span'),\r\n                    idStr = $this.attr('id');\r\n                rightkeyPop.css({left : oLeft, top : oTop, zIndex : 2999}).attr('rightkey_click_id', idStr).show();\r\n            }\r\n        });\r\n        $(document).on('mouseout', '#topocontent div.elebox', function(){\r\n            rightkeyPop.hide();\r\n        });\r\n        $(document).on('mouseover', '#topocontent div.elebox', function(){\r\n            return false;\r\n        });\r\n        $(document).on('click', '#delEle', function(){\r\n            let idStr = rightkeyPop.attr('rightkey_click_id');\r\n            // $.confirmInfo({\r\n            //     title : '删除元素及链接',\r\n            //     text : '确认删除此元素及其链接吗？',\r\n            //     sure : function(){\r\n                    instance.removeAllEndpoints(idStr);\r\n                    instance.remove(idStr);\r\n            //     }\r\n            // });\r\n        });\r\n        $(document).on('click', '#relationWrap a', function(){\r\n            var txt = $(this).text(),\r\n                idStr = rightkeyPop.attr('rightkey_click_id');\r\n            $('#' + idStr).children('span').text(txt);\r\n            relationWrap.hide();\r\n            rightkeyPop.hide();\r\n            instance.revalidate(idStr);\r\n        });\r\n        rightkeyPop.mouseover(function(){\r\n            $(this).show();\r\n            return false;\r\n        });\r\n        relevanceBox.hover(function(){\r\n            relationWrap.show();\r\n        }, function(){\r\n            relationWrap.hide();\r\n        });\r\n        $('body').mouseover(function(){\r\n            rightkeyPop.hide();\r\n        });\r\n\r\n        //jsPlumb事件\r\n        instance.bind(\"click\", function(info) {//点解连接线删除连接（bug,点击endpoint也能删除，但是点击label能提示不能删除）\r\n                detachLine(info);\r\n         });\r\n        instance.bind(\"connection\", function(info,originalEvent) {//更改label关系\r\n            console.log(info)\r\n            info.connection.getOverlay(\"label\").setLabel(labelTxt);\r\n        });\r\n        instance.bind(\"connectionDrag\", function(info) {//更改连接链颜色\r\n            info.setPaintStyle({fillStyle : lineColor, stroke: lineColor});\r\n        });\r\n        instance.bind(\"connectionDragStop\", function(info) {//点击连接线、overlay、label提示删除连线 + 不能以自己作为目标元素\r\n            if(info.sourceId === info.targetId){\r\n                // $.popupTips('不能以自己作为目标元素');\r\n                instance.detach(info); \r\n            }else{\r\n                info.unbind('click');\r\n                info.bind('click',function(){\r\n                    detachLine(info);\r\n                });\r\n            };\r\n        });\r\n        function detachLine(info){//删除连接\r\n            // $.confirmInfo({\r\n            //     title : '删除连接',\r\n            //     text : '确认删除此链接吗？',\r\n            //     sure : function(){\r\n                instance.detach(info); \r\n                // }\r\n            // });\r\n        }\r\n        function renderConnect(newid){//渲染\r\n            instance.draggable(newid);\r\n            instance.doWhileSuspended(function(){\r\n                var isFilterSupported = instance.isDragSupported();\r\n                if(isFilterSupported){\r\n                    instance.makeSource(newid, {filter:\".dragPoint\",anchor:\"Continuous\"}, pstyle);\r\n                }\r\n                else{\r\n                    var eps = jsPlumb.getSelector(\".dragPoint\");\r\n                    for (var i = 0; i < eps.length; i++) {\r\n                        var e = eps[i], p = e.parentNode;\r\n                        instance.makeSource(e, {parent:p, anchor:\"Continuous\"}, pstyle);\r\n                    }\r\n                }    \r\n            });\r\n            instance.makeTarget(newid, {dropOptions:{hoverClass:\"dragHover\"}, anchor:\"Continuous\"}, pstyle);\r\n        }\r\n\r\n        //拖动创建元素\r\n        lefticon.children('div.iconitems').draggable({\r\n            helper: 'clone',\r\n            scope: 'topo'\r\n        });\r\n\r\n        var mm = this.mOpen;\r\n        // var {new_value} = this.state;\r\n        topocontent.droppable({\r\n            scope: 'topo',\r\n            drop: function(event, ui){\r\n                mm();\r\n                //获取基本元素与参数\r\n                var $this = $(this),\r\n                    dragui = ui.draggable,\r\n                    fatop = parseInt($this.offset().top),\r\n                    faleft = parseInt($this.offset().left),\r\n                    uitop = parseInt(ui.offset.top),\r\n                    uileft = parseInt(ui.offset.left),\r\n                    spantxt = dragui.children('span').text(),\r\n                    uid = dragui.attr('icontype'),\r\n                    alluid = topocontent.children('div.' + uid);\r\n                //ID计算\r\n                var allicon = alluid.length,\r\n                    idnum = 0,\r\n                    idArr  = [];\r\n                alluid.each(function(i) {\r\n                    idArr.push(parseInt($(this).attr('id').split('_')[1]));\r\n                });\r\n                idArr.sort(function(a,b){return a>b?1:-1});\r\n                for(var i = 0; i < allicon; i++){\r\n                var idArrOne = parseInt(idArr[i]);\r\n                    if(i !== idArrOne){\r\n                        idnum = idArrOne - 1;\r\n                        break;\r\n                    }else{\r\n                        idnum = allicon;\r\n                    } \r\n                }\r\n                //插入元素组织\r\n                var newstyle = 'left:' + (uileft - faleft) + 'px;top:' + (uitop - fatop) + 'px',\r\n                    newid = uid + '_' + idnum,\r\n                    str = '<div class=\"elebox '+uid+'\" id='+newid+' style='+newstyle+'><span class=\"dragPoint\">'+spantxt+'</span></div>';\r\n                \r\n                $this.append(str);\r\n                renderConnect(newid);\r\n                instance.revalidate(newid);\r\n                // $(\"#\" + newid).draggable({ containment: \"parent\" });\r\n            }\r\n});\r\n\r\n//-------------------编辑(end)-------------------\r\n        }\r\n\r\n        mOpen=()=>{\r\n            let newProps = parseInt(this.state.propsWatch);\r\n            this.setState({ \r\n                model:{ \r\n                        title:\"新增\",\r\n                        visible: true,\r\n                        },\r\n                propsWatch:newProps++\r\n            })\r\n            // return this.state.new_value\r\n        }\r\n        handleOk(){\r\n            this.setState({\r\n                model:{\r\n                    visible:false,\r\n                }\r\n            })\r\n        }\r\n        handleCancel(){\r\n            this.setState({\r\n                model:{\r\n                    visible:false,\r\n                }\r\n            })\r\n        }\r\n        //  modal中form表单验证失败函数\r\n  onFinishFailed = (values) => {\r\n    //  console.log('验证失败：', values);\r\n  }\r\n  //  modal中form表单验证成功函数\r\n  onFinish = (values) => {\r\n      console.log(values)\r\n      this.setState({\r\n        new_value:values.tp_no,\r\n        model:{\r\n          visible:false,\r\n            },\r\n      });\r\n    //   document.getElementById(\"elebox\").innerHTML = this.state.new_value;\r\n    }\r\n    viewClick(){\r\n        $(\"#lefticon\").css(\"background\",\"green\").toggle().slideUp(2000).slideDown(2000);; \r\n    }\r\n    render() {\r\n        return (\r\n            <div>\r\n            <div className=\"topocon\">\r\n            <div className=\"topoleft\">\r\n                <div className=\"companylogo\"><img src={logo} alt=\"\" /></div>\r\n                <div className=\"lefticon\" id=\"lefticon\">\r\n                    <div className=\"iconitems\" icontype=\"uiscreen\">\r\n                        <img src={block0} alt=\"\" />\r\n                        <span>显示器</span>\r\n                    </div>\r\n                    <div className=\"iconitems\" icontype=\"uicamera\">\r\n                        <img src={block1} alt=\"\" />\r\n                        <span>摄像头</span>\r\n                    </div>\r\n                    <div className=\"iconitems\" icontype=\"uiprint\">\r\n                        <img src={block2} alt=\"\" />\r\n                        <span>打印机</span>\r\n                    </div>\r\n                    <div className=\"iconitems\" icontype=\"uifirework\">\r\n                        <img src={block3} alt=\"\" />\r\n                        <span>防火墙</span>\r\n                    </div>\r\n                    <div className=\"iconitems lin\" icontype=\"uifirework\">\r\n                         {/*<svg width=\"100%\" height=\"100%\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" style={{display:\"none\"}}>\r\n                            <path d=\"M 50 0,L 100 30,L 50 60,L 0 30,Z\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/xhtml\"\r\n                                style={{ fill:\"red\",stroke:\"#000\",strokeWidth:1}} >\r\n                            </path>\r\n                        </svg>\r\n                       */}\r\n                        <span>防火墙</span>\r\n                    </div> \r\n                </div>\r\n            </div>\r\n            <div className=\"toporight\">\r\n                <div className=\"funcbtn\">\r\n                    <div className=\"morebtn\">\r\n                        <span id=\"saveTopoBtn\"><font>保存</font></span>\r\n                        <span id=\"viewTopoBtn\" onClick={this.viewClick.bind(this)}><font>预览</font></span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"topocontent\" id=\"topocontent\"></div>\r\n            </div>\r\n        </div>\r\n        <div className=\"rightkeypop\" id=\"rightkeyPop\">\r\n            <span className=\"delele\" id=\"delEle\">删除元素</span>\r\n        </div>\r\n        <ModelChart \r\n            propsWatch={this.state.new_value}\r\n            model={this.state.model}\r\n            onOk={this.handleOk.bind(this)}\r\n            onCancel={this.handleCancel.bind(this)}\r\n            onFinishFailed={this.onFinishFailed.bind(this)}\r\n            onFinish={this.onFinish.bind(this)}\r\n            formInfo={this.state.form_info}\r\n        />\r\n        </div>\r\n        \r\n        )\r\n    }\r\n}\r\n\r\nexport default TablePage;"]},"metadata":{},"sourceType":"module"}