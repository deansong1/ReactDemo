// Copyright (C) 1998-2020 by Northwoods Software Corporation. All Rights Reserved.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("gojs"),require("react")):"function"==typeof define&&define.amd?define(["exports","gojs","react"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).goJsReact={},t.go,t.React)}(this,(function(t,e,r){"use strict";var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function a(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var n=function(t){function o(e){var o=t.call(this,e)||this;return o.modelChangedListener=null,o.divRef=r.createRef(),o}return a(o,t),o.prototype.getDiagram=function(){return null===this.divRef.current?null:e.Diagram.fromDiv(this.divRef.current)},o.prototype.componentDidMount=function(){var t=this;if(null!==this.divRef.current){var r=this.props.initDiagram();r.div=this.divRef.current,this.modelChangedListener=function(e){if(e.isTransactionFinished&&e.model&&!e.model.isReadOnly&&t.props.onModelChange){var r=e.model.toIncrementalData(e);null!==r&&t.props.onModelChange(r)}},r.addModelChangedListener(this.modelChangedListener),r.delayInitialization((function(){r.model.commit((function(r){r.mergeNodeDataArray(t.props.nodeDataArray),void 0!==t.props.linkDataArray&&r instanceof e.GraphLinksModel&&r.mergeLinkDataArray(t.props.linkDataArray),void 0!==t.props.modelData&&r.assignAllDataProperties(r.modelData,t.props.modelData)}),"gojs-react init merge")}))}},o.prototype.componentWillUnmount=function(){var t=this.getDiagram();null!==t&&(t.div=null,null!==this.modelChangedListener&&(t.removeModelChangedListener(this.modelChangedListener),this.modelChangedListener=null))},o.prototype.shouldComponentUpdate=function(t,e){return!t.skipsDiagramUpdate&&(t.nodeDataArray!==this.props.nodeDataArray||t.linkDataArray!==this.props.linkDataArray||t.modelData!==this.props.modelData)},o.prototype.componentDidUpdate=function(t,r){var o=this.getDiagram();if(null!==o){var a=o.model;a.startTransaction("update data"),a.mergeNodeDataArray(this.props.nodeDataArray),void 0!==this.props.linkDataArray&&a instanceof e.GraphLinksModel&&a.mergeLinkDataArray(this.props.linkDataArray),void 0!==this.props.modelData&&a.assignAllDataProperties(a.modelData,this.props.modelData),a.commitTransaction("update data")}},o.prototype.render=function(){return r.createElement("div",{ref:this.divRef,className:this.props.divClassName})},o}(r.Component),i=function(t){function o(e){var o=t.call(this,e)||this;return o.divRef=r.createRef(),o}return a(o,t),o.prototype.getOverview=function(){return null===this.divRef.current?null:e.Diagram.fromDiv(this.divRef.current)},o.prototype.componentDidMount=function(){var t;null!==this.divRef.current&&(void 0!==this.props.initOverview?t=this.props.initOverview():(t=new e.Overview).contentAlignment=e.Spot.Center,t.div=this.divRef.current,t.observed=this.props.observedDiagram)},o.prototype.componentWillUnmount=function(){var t=this.getOverview();null!==t&&(t.div=null,t.observed=null)},o.prototype.shouldComponentUpdate=function(t,e){return t.observedDiagram!==this.props.observedDiagram},o.prototype.componentDidUpdate=function(t,e){var r=this.getOverview();null!==r&&(r.observed=this.props.observedDiagram)},o.prototype.render=function(){return r.createElement("div",{ref:this.divRef,className:this.props.divClassName})},o}(r.Component),s=function(t){function o(e){var o=t.call(this,e)||this;return o.divRef=r.createRef(),o}return a(o,t),o.prototype.getPalette=function(){return null===this.divRef.current?null:e.Diagram.fromDiv(this.divRef.current)},o.prototype.componentDidMount=function(){var t=this;if(null!==this.divRef.current){var r=this.props.initPalette();r.div=this.divRef.current,r.delayInitialization((function(){r.model.commit((function(r){r.mergeNodeDataArray(t.props.nodeDataArray),void 0!==t.props.linkDataArray&&r instanceof e.GraphLinksModel&&r.mergeLinkDataArray(t.props.linkDataArray),void 0!==t.props.modelData&&r.assignAllDataProperties(r.modelData,t.props.modelData)}),null)}))}},o.prototype.componentWillUnmount=function(){var t=this.getPalette();null!==t&&(t.div=null)},o.prototype.shouldComponentUpdate=function(t,e){return t.nodeDataArray!==this.props.nodeDataArray||t.linkDataArray!==this.props.linkDataArray||t.modelData!==this.props.modelData},o.prototype.componentDidUpdate=function(t,r){var o=this.getPalette();if(null!==o){var a=o.model;a.startTransaction("update data"),a.mergeNodeDataArray(this.props.nodeDataArray),void 0!==this.props.linkDataArray&&a instanceof e.GraphLinksModel&&a.mergeLinkDataArray(this.props.linkDataArray),void 0!==this.props.modelData&&a.assignAllDataProperties(a.modelData,this.props.modelData),a.commitTransaction("update data")}},o.prototype.render=function(){return r.createElement("div",{ref:this.divRef,className:this.props.divClassName})},o}(r.Component);t.ReactDiagram=n,t.ReactOverview=i,t.ReactPalette=s,Object.defineProperty(t,"__esModule",{value:!0})}));
